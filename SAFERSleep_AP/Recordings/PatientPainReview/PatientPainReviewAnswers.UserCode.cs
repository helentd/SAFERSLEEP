///////////////////////////////////////////////////////////////////////////////
//
// This file was automatically generated by RANOREX.
// Your custom recording code should go in this file.
// The designer will only add methods to this file, so your custom code won't be overwritten.
// http://www.ranorex.com
//
///////////////////////////////////////////////////////////////////////////////

using System;
using System.Collections.Generic;
using System.Text;
using System.Text.RegularExpressions;
using System.Drawing;
using System.Threading;
using WinForms = System.Windows.Forms;

using Ranorex;
using Ranorex.Core;
using Ranorex.Core.Repository;
using Ranorex.Core.Testing;

namespace SAFERSleep_AP.Recordings.PatientPainReview
{
    public partial class PatientPainReviewAnswers
    {
        /// <summary>
        /// This method gets called right after the recording has been started.
        /// It can be used to execute recording specific initialization code.
        /// </summary>
        private void Init()
        {
            // Your recording specific initialization code goes here.
        }

        public void AnswerPainReviewQuestions(string ReviewQuestion, string ReviewAnswer, string QuestionType, string IsAnswer)
        {
           //// only enter answer for quessions which have answers in test data
           if ( IsAnswer=="Yes" && ReviewAnswer != "")
           {           	
           	//// Check if question type is optional queation (combobox)
	           	if (QuestionType=="Option") 
	           	{
	           		// 1. click on the question answer
		           	Report.Log(ReportLevel.Info, "Mouse", "Click on the question "+ ReviewQuestion, repo.MainWindow.PatientPainReview.PainReviewAnswer_SelectOptionInfo, new RecordItemIndex(0));
		           	repo.MainWindow.PatientPainReview.PainReviewAnswer_SelectOption.Click();
		           	
		           	//2 Find answer item to click on
		           	IList<ListItem> lstItems = 	repo.MainWindow.PatientPainReview.PainReviewAnswer_SelectOption.Items;          	
		          	// go through all combobox items to select the answer
		          	if (lstItems != null && lstItems.Count> 0) {
		            	for (int i = 0; i < lstItems.Count; i++) {
		            		if (lstItems[i].Text== ReviewAnswer) {
		           			
		           				//Report.Log(ReportLevel.Info,"Path " + lstItems[i].GetPath().ToString());
		           				Report.Log(ReportLevel.Info,"CLick on answer item: " + ReviewAnswer );          				
		            			
		            			lstItems[i].Selected= true;
		            			lstItems[i].Click();
		            			Delay.Milliseconds(200);
		            			break;
		            		}
		            	}
		            }
	           	}
	           ///// if question type is YesNo question
	           	else if (QuestionType=="YesNo") 
	           	{
	           		// 1. click on the question answer
		           		Report.Log(ReportLevel.Info, "Mouse", "Select question: " + ReviewQuestion + ". Answer is: " + ReviewAnswer, repo.MainWindow.PatientPainReview.PainReviewAnswer_YesNoInfo, new RecordItemIndex(0));
		              	//Report.Log(ReportLevel.Info,"Click on item: " + strAnswer);
		              	repo.MainWindow.PatientPainReview.PainReviewAnswer_YesNo.Click();
			          	Delay.Milliseconds(200);
	           	}
           }
        }

    }
}
